import{aL as O,r as y,aG as P,a as R,aM as V,aN as W,aO as C,aP as x,aQ as U,aR as S,aS as G,aT as $,aU as K,aV as F,aW as Q,aX as X,aY as Y,w as b,aZ as Z,L as z,o as J,a_ as I,g as _}from"./index.c74af1de.js";import{u as ee}from"./notify.hook.477b6e06.js";const ne=O("experiences",()=>{const n=y([]),c=y({}),s=y(!1),a=y(null),{error:l}=ee(),f=P(),p=async()=>{if(!D.value){s.value=!0;try{const e=await V(W(C(x,"workExperience"),U("dateEnd","desc")));if(e.docs.length)n.value=e.docs.map(t=>t.data());else throw new Error("Ha surgido alg\xFAn tipo de error en la consulta. compruebe la colecci\xF3n, los documentos o los campos")}catch(e){a.value=S[e.code]||e.message,l(a.value)}finally{s.value=!1}}},r=async e=>{await G($(x,"workExperience",e));const t=n.value.findIndex(o=>o.idDoc===e);t>-1&&n.value.splice(t,1)},m=async e=>{const t=n.value.find(o=>o.idDoc===e);c.value=t||await v(e)},v=async e=>{const t=$(x,"workExperience",e),o=await K(t);return o.exists()?o.data():{}},u=async e=>{const t=new Date(e.dateStart),o=new Date(e.dateEnd);try{s.value=!0;const i=$(C(x,"workExperience")),w={idDoc:i.id,createdAt:Date.now(),...e,dateStart:F.fromDate(t),dateEnd:F.fromDate(o)};await Q(i,w),n.value.push(w),f.push({name:"WorkExperienceAdmin"})}catch(i){a.value=S[i.code]||i.message,l(a.value)}finally{s.value=!1}},d=async(e,t)=>{let{code:o,title:i,jobTitle:w,province:B,place:L,comments:N,dateStart:T,dateEnd:j,is_certificado_profesionalidad:q}=t;const h={code:o,title:i,jobTitle:w,province:B,place:L,comments:N,dateStart:T,dateEnd:j,is_certificado_profesionalidad:q},A=new Date(h.dateStart);t.dateStart=h.dateStart=F.fromDate(A);const H=new Date(t.dateEnd);t.dateEnd=h.dateEnd=F.fromDate(H);try{s.value=!0,await X($(x,"workExperience",e),h)}catch(g){a.value=S[g.code]||g.message,l(a.value)}finally{s.value=!1}const k=n.value.findIndex(g=>g.idDoc===e);k>-1&&(n.value[k]=t)},M=R(()=>Object.keys(c.value).length!==0),D=R(()=>n.value.length>0);return{experiences:n,experience:c,isExperience:M,loading:s,error:a,isExperiences:D,setExperiencesFromCloud:p,setExperience:m,addExperience:u,updateExperience:d,deleteExperience:r}});let E=0;const se={fullscreen:Boolean,noRouteFullscreenExit:Boolean},re=["update:fullscreen","fullscreen"];function oe(){const n=_(),{props:c,emit:s,proxy:a}=n;let l,f,p;const r=y(!1);Y(n)===!0&&b(()=>a.$route.fullPath,()=>{c.noRouteFullscreenExit!==!0&&u()}),b(()=>c.fullscreen,d=>{r.value!==d&&m()}),b(r,d=>{s("update:fullscreen",d),s("fullscreen",d)});function m(){r.value===!0?u():v()}function v(){r.value!==!0&&(r.value=!0,p=a.$el.parentNode,p.replaceChild(f,a.$el),document.body.appendChild(a.$el),E++,E===1&&document.body.classList.add("q-body--fullscreen-mixin"),l={handler:u},I.add(l))}function u(){r.value===!0&&(l!==void 0&&(I.remove(l),l=void 0),p.replaceChild(a.$el,f),r.value=!1,E=Math.max(0,E-1),E===0&&(document.body.classList.remove("q-body--fullscreen-mixin"),a.$el.scrollIntoView!==void 0&&setTimeout(()=>{a.$el.scrollIntoView()})))}return Z(()=>{f=document.createElement("span")}),z(()=>{c.fullscreen===!0&&v()}),J(u),Object.assign(a,{toggleFullscreen:m,setFullscreen:v,exitFullscreen:u}),{inFullscreen:r,toggleFullscreen:m}}export{se as a,re as b,oe as c,ne as u};
